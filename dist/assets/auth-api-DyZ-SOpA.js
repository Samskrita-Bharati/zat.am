import{a,d as i}from"./firebase-config-DVCrEPzz.js";import{GoogleAuthProvider as l,signInWithEmailAndPassword as m,signInWithPopup as h,createUserWithEmailAndPassword as w,updateProfile as g,onAuthStateChanged as f,EmailAuthProvider as p,reauthenticateWithCredential as P,updatePassword as y,signOut as A}from"https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";import{doc as o,getDoc as c,setDoc as U,serverTimestamp as W}from"https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";const v=new l,b=async(t,s)=>await w(a,t,s),G=async(t,s)=>await m(a,t,s),R=async()=>await A(a),k=()=>new Promise((t,s)=>{f(a,e=>{e?t(e):s(null)})}),N=async(t,s)=>await g(t,s),O=async()=>{const t=await h(a,v);return await x(t.user),t},x=async(t,s={})=>{if(!t)return;const e=o(i,"users",t.uid);if((await c(e)).exists())return;const{displayName:u,email:d}=t,{isAdmin:D,...r}=s||{};await U(e,{email:d||"",name:u||r.name||"",isAdmin:!1,createdAt:W(),...r})},S=async()=>{const t=a.currentUser;if(!t)return null;const s=o(i,"users",t.uid),e=await c(s);return e.exists()?{id:e.id,...e.data()}:null},T=async(t,s)=>{const e=a.currentUser,n=p.credential(e.email,t);return await P(e,n),await y(e,s)};export{b as a,T as b,k as c,R as d,x as e,S as g,G as l,O as s,N as u};
